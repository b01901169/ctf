from pwn import *
import random
import string
import hashlib

r = remote('146.185.143.84', 13245)

raw_input('pause')

junk = r.recvline()
print junk
junk = r.recvline()
print junk
junk = r.recvline()
print junk
junk = r.recvline()
print junk


line = r.recvline()
target = line[:-1].split()[-1]
print 'target:', target

count = 0
while 1:
  digits = "".join( [random.choice(string.digits) for i in xrange(8)] )
  chars = "".join( [random.choice(string.letters) for i in xrange(15)] )
  sha = hashlib.sha256(chars).hexdigest()
  #print sha[-6:]
  if sha[-6:] == target:
    break
  count += 1
  if count % 100000 == 0:
    print count

r.sendline(chars)

junk = r.recvline()
print junk
junk = r.recvline()
print junk

line_a = r.recvline()
print line_a
line_b = r.recvline()  
print line_b

a = int(line_a[:-1].split()[-1])
b = int(line_b[:-1].split()[-1])

print 'a:', a
print 'b:', b
  

r.interactive()

